{"version":3,"file":"commonHelpers.js","sources":["../src/api/keys.js","../src/api/fetch-api.js","../src/api/createMarkup.js","../src/api/toasts.js","../src/main.js"],"sourcesContent":["export const API_KEY = '30189799-59836afbb9e42d0c8f8f60963';\nexport const BASE_URL = 'https://pixabay.com/api/';\nexport const PER_PAGE = 40;","import axios from 'axios';\nimport { API_KEY, BASE_URL, PER_PAGE } from './keys.js';\n\nexport const fetchImages = async (query, page) => {\n  const res = await axios(`${BASE_URL}`, {\n    params: {\n      key: API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page,\n      per_page: PER_PAGE,\n    },\n  });\n  return res.data;\n};\n","export function createMarkup(arr) {\n  return arr.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => {\n    return `\n      <a href=\"${largeImageURL}\" class='photo-card'>\n        <img class='photo' src='${webformatURL}' alt='${tags}' loading='lazy' />\n        <div class='info'>\n          <p class='info-item'>\n            <b>Likes</b>\n            ${likes}\n          </p>\n          <p class='info-item'>\n            <b>Views</b>\n            ${views}\n          </p>\n          <p class='info-item'>\n            <b>Comments</b>\n            ${comments}\n          </p>\n          <p class='info-item'>\n            <b>Downloads</b>\n            ${downloads}\n          </p>\n        </div>\n      </a>\n    `;\n  }).join('');\n}","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nexport function toastError () {\n  iziToast.error({\n    position: 'topRight',\n    message: 'Sorry, there are no images matching your search query. Please try again.'\n  });\n}\n\nexport function toastInfoSearch() {\n  iziToast.info({\n    position: 'topRight',\n    message: \"❗️For an another search, enter new query!\"\n  });\n}\n\nexport function toastFoundedImages(data) {\n  iziToast.success({\n    position: 'topRight',\n    message: `Hooray! We found ${data.totalHits} images.`\n  })\n}\n\nexport function endOfResultsInfo() {\n  iziToast.info({\n    position: 'topRight',\n    message: 'We\\'re sorry, but you\\'ve reached the end of search results.'\n  });\n}","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport { fetchImages } from './api/fetch-api.js';\nimport { createMarkup } from './api/createMarkup.js';\nimport { endOfResultsInfo, toastError, toastFoundedImages, toastInfoSearch } from './api/toasts.js';\nimport { PER_PAGE } from './api/keys.js';\n\nconst form = document.querySelector('.search-form');\nconst gallery = document.querySelector('.gallery');\nconst loadMoreBtn = document.querySelector('.load-more');\n\nloadMoreBtn.classList.add('hidden');\n\nlet numberPage = 1;\nlet existSearchQuery;\nlet lightbox;\nlet isLoading = false;\n\nform.addEventListener('submit', onHandleSubmit);\n// loadMoreBtn.addEventListener('click', loadMore);\n\nfunction onHandleSubmit(e) {\n  e.preventDefault();\n  // loadMoreBtn.classList.add('hidden');\n  const query = e.currentTarget.elements.searchQuery.value.trim();\n\n  if (query === existSearchQuery) {\n    toastInfoSearch();\n    return;\n  }\n  gallery.innerHTML = '';\n  existSearchQuery = query;\n\n  fetchImages(query, numberPage)\n  .then(data => {\n    if (!data.totalHits) {\n      toastError();\n      return;\n    }\n\n    if (numberPage === 1) {\n      toastFoundedImages(data);\n    }\n\n    if (data.totalHits <= numberPage * PER_PAGE) {\n      endOfResultsInfo();\n    }\n\n    // if (data.totalHits > numberPage * PER_PAGE) {\n    //   loadMoreBtn.classList.remove('hidden');\n    // }\n    const markup = createMarkup(data.hits);\n    gallery.insertAdjacentHTML('afterbegin', markup);\n    lightbox = new SimpleLightbox(`.gallery a`);\n  })\n  .catch(err => {\n    console.log(err);\n  });\n}\n\nexport async function loadMore() {\n  if (isLoading) {\n    return;\n  }\n\n  isLoading = true;\n  numberPage += 1;\n\n  const searchQuery = form.elements.searchQuery.value.trim();\n  const data = await fetchImages(searchQuery, numberPage + 1);\n\n  gallery.insertAdjacentHTML('beforeend', createMarkup(data.hits));\n  lightbox.refresh();\n  // loadMoreBtn.classList.remove('hidden');\n\n  const { height: cardHeight } = document\n  .querySelector(\".gallery\")\n  .firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: \"smooth\",\n  });\n\n  isLoading = false;\n}\n\nwindow.addEventListener('scroll', () => {\n  const { scrollTop, scrollHeight, clientHeight } = document.documentElement;\n\n  if (clientHeight + scrollTop >= scrollHeight * 0.9) {\n    loadMore();\n  }\n});"],"names":["API_KEY","BASE_URL","PER_PAGE","fetchImages","query","page","axios","createMarkup","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","toastError","iziToast","toastInfoSearch","toastFoundedImages","data","endOfResultsInfo","form","gallery","loadMoreBtn","numberPage","existSearchQuery","lightbox","isLoading","onHandleSubmit","e","markup","SimpleLightbox","err","loadMore","searchQuery","cardHeight","scrollTop","scrollHeight","clientHeight"],"mappings":"owBAAO,MAAMA,EAAU,qCACVC,EAAW,2BACXC,EAAW,GCCXC,EAAc,MAAOC,EAAOC,KAC3B,MAAMC,EAAM,GAAGL,IAAY,CACrC,OAAQ,CACN,IAAKD,EACL,EAAGI,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAAC,EACA,SAAUH,CACX,CACL,CAAG,GACU,KCfN,SAASK,EAAaC,EAAK,CAChC,OAAOA,EAAI,IAAI,CAAC,CAAE,aAAAC,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAS,IAC7E;AAAA,iBACML;AAAA,kCACiBD,WAAsBE;AAAA;AAAA;AAAA;AAAA,cAI1CC;AAAA;AAAA;AAAA;AAAA,cAIAC;AAAA;AAAA;AAAA;AAAA,cAIAC;AAAA;AAAA;AAAA;AAAA,cAIAC;AAAA;AAAA;AAAA;AAAA,KAKX,EAAE,KAAK,EAAE,CACZ,CCvBO,SAASC,GAAc,CAC5BC,EAAS,MAAM,CACb,SAAU,WACV,QAAS,0EACb,CAAG,CACH,CAEO,SAASC,GAAkB,CAChCD,EAAS,KAAK,CACZ,SAAU,WACV,QAAS,2CACb,CAAG,CACH,CAEO,SAASE,EAAmBC,EAAM,CACvCH,EAAS,QAAQ,CACf,SAAU,WACV,QAAS,oBAAoBG,EAAK,mBACtC,CAAG,CACH,CAEO,SAASC,GAAmB,CACjCJ,EAAS,KAAK,CACZ,SAAU,WACV,QAAS,4DACb,CAAG,CACH,CCtBA,MAAMK,EAAO,SAAS,cAAc,cAAc,EAC5CC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAc,SAAS,cAAc,YAAY,EAEvDA,EAAY,UAAU,IAAI,QAAQ,EAElC,IAAIC,EAAa,EACbC,EACAC,EACAC,EAAY,GAEhBN,EAAK,iBAAiB,SAAUO,CAAc,EAG9C,SAASA,EAAeC,EAAG,CACzBA,EAAE,eAAc,EAEhB,MAAM1B,EAAQ0B,EAAE,cAAc,SAAS,YAAY,MAAM,OAEzD,GAAI1B,IAAUsB,EAAkB,CAC9BR,IACA,MACD,CACDK,EAAQ,UAAY,GACpBG,EAAmBtB,EAEnBD,EAAYC,EAAOqB,CAAU,EAC5B,KAAKL,GAAQ,CACZ,GAAI,CAACA,EAAK,UAAW,CACnBJ,IACA,MACD,CAEGS,IAAe,GACjBN,EAAmBC,CAAI,EAGrBA,EAAK,WAAaK,EAAavB,GACjCmB,IAMF,MAAMU,EAASxB,EAAaa,EAAK,IAAI,EACrCG,EAAQ,mBAAmB,aAAcQ,CAAM,EAC/CJ,EAAW,IAAIK,EAAe,YAAY,CAC9C,CAAG,EACA,MAAMC,GAAO,CACZ,QAAQ,IAAIA,CAAG,CACnB,CAAG,CACH,CAEO,eAAeC,GAAW,CAC/B,GAAIN,EACF,OAGFA,EAAY,GACZH,GAAc,EAEd,MAAMU,EAAcb,EAAK,SAAS,YAAY,MAAM,OAC9CF,EAAO,MAAMjB,EAAYgC,EAAaV,EAAa,CAAC,EAE1DF,EAAQ,mBAAmB,YAAahB,EAAaa,EAAK,IAAI,CAAC,EAC/DO,EAAS,QAAO,EAGhB,KAAM,CAAE,OAAQS,CAAU,EAAK,SAC9B,cAAc,UAAU,EACxB,kBAAkB,sBAAqB,EAExC,OAAO,SAAS,CACd,IAAKA,EAAa,EAClB,SAAU,QACd,CAAG,EAEDR,EAAY,EACd,CAEA,OAAO,iBAAiB,SAAU,IAAM,CACtC,KAAM,CAAE,UAAAS,EAAW,aAAAC,EAAc,aAAAC,CAAY,EAAK,SAAS,gBAEvDA,EAAeF,GAAaC,EAAe,IAC7CJ,GAEJ,CAAC"}